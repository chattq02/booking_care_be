enum SupperAdmin {
  YES @map("1") // trong DB sẽ là 1
  NO  @map("0") // trong DB sẽ là 0
}

enum Gender {
  MALE   @map("male") // Nam
  FEMALE @map("female") // Nữ
  OTHER  @map("other") // Khác
}

enum IsVerify {
  YES @map("1") // trong DB sẽ là 1
  NO  @map("0") // trong DB sẽ là 0
}

enum UserType {
  Admin
  Doctor
  Patient
}

enum IsUpdateProfile {
  YES @map("1") // trong DB sẽ là 1
  NO  @map("0") // trong DB sẽ là 0
}

enum UserStatus {
  Active
  InActive
  Banned
  Pending
}

model User {
  id                   Int       @id @default(autoincrement()) // Khóa chính, tự tăng
  uuid                 String    @unique @default(uuid()) // Mã định danh duy nhất (UUID)
  email                String    @unique @db.VarChar(255) // Email đăng nhập (duy nhất)
  password             String    @db.VarChar(555) // Mật khẩu (đã hash) 
  fullName             String    @db.VarChar(255) // Họ và tên đầy đủ 
  phone                String?   @unique @db.VarChar(255) // Số điện thoại (có thể trống)
  gender               Gender? // Giới tính (Nam/Nữ/Khác)
  dateOfBirth          DateTime? // Ngày sinh
  address              String?   @db.VarChar(555) // Địa chỉ 
  user_type            UserType  @default(Patient) // Loại người dùng (Admin/Bác sĩ/Bệnh nhân)
  cccd                 String?   @db.VarChar(255) // CCCD (chứng minh nhân dân)
  bhyt                 String?   @db.VarChar(255) // BHYT (bảo hiểm y tế)
  nation               String?   @db.VarChar(255) // Dân tộc
  avatar               String? // Đường dẫn ảnh đại diện
  remark               String? // Ghi chú
  practice_certificate String? // chứng chỉ hành nghề

  specialty_id         Int? // Chuyên khoa (nếu là bác sĩ)
  experience           Int? // Số năm kinh nghiệm (nếu là bác sĩ)
  description          String? // Mô tả thêm (nếu là bác sĩ)
  password_reset_token String?         @db.VarChar(555) // Token dùng để reset mật khẩu
  is_verify            IsVerify        @default(NO) // Đã xác minh email chưa
  is_update_profile    IsUpdateProfile @default(NO) // Đã cập nhật thông tin cá nhân chưa
  is_supper_admin      SupperAdmin     @default(NO) // Là admin cao nhất hay không
  user_status          UserStatus      @default(InActive)
  created_by           Int? // Người tạo
  academicTitleId      Int? // FK: Id của học vị / chức danh

  academicTitle         AcademicTitle?    @relation(fields: [academicTitleId], references: [id], onDelete: Restrict)
  facilities            MedicalFacility[] @relation("FacilityDoctors")
  roles                 UserRole[]
  appointmentsAsDoctor  Appointment[]     @relation("DoctorAppointments") // Danh sách lịch khám mà user là bác sĩ
  appointmentsAsPatient Appointment[]     @relation("PatientAppointments") // Danh sách lịch khám mà user là bệnh nhân
  schedules             Schedule[] // Các ca làm việc của bác sĩ
  departments           Department[]      @relation("DoctorDepartments") // Nhiều bác sĩ ↔ nhiều chuyên khoa
  tokens                Token[]
  sentMessages          Message[]         @relation("SentMessages")
  receivedMessages      Message[]         @relation("ReceivedMessages")

  createdAt DateTime @default(now()) // Thời gian tạo
  updatedAt DateTime @updatedAt // Tự cập nhật khi thay đổi

  @@map("users") // Map tên bảng trong DB thành "users"
}
